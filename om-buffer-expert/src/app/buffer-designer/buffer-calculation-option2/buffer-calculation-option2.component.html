
<mat-card class="main-card-container">
  <form [formGroup]="bufferForm" (ngSubmit)="onSubmit()" class="formf">
    <mat-card class="calculator">
      <mat-form-field class="option1-full-width" appearance="fill">
        <input type="text" placeholder="Select buffer species" aria-label="Number" matInput formControlName="bufferspeckey" [matAutocomplete]="auto">
  <mat-autocomplete #auto="matAutocomplete" (optionSelected)="onBufferSpeciesSelected($event)">
    <mat-option *ngFor="let option of bufferSpeciesKeys" [value]="option">
      {{option}}
    </mat-option>
  </mat-autocomplete>
      </mat-form-field>
      <div class="col1">

        <mat-form-field class="option1-full-width_Left" appearance="fill">
          <mat-label for="acidicCompound">Acidic Compound</mat-label>
          <mat-select id="acidicCompound" name="acidicCompound"
            ngDefaultControl
            formControlName="acidicCompound"    required>
            <mat-option *ngFor="let compound of acidCompounds"
              [value]="compound" >
              {{ compound }}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field class="option1-full-width_Left" appearance="fill">
          <mat-label>Basic Compound</mat-label>
          <mat-select formControlName="basicCompound"   required>
            <mat-option *ngFor="let compound of basicCompounds"
              [value]="compound">
              {{ compound }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field class="option1-full-width_Left" appearance="fill">
          <mat-label>Salt Compound</mat-label>
          <mat-select formControlName="saltCompound" >
            <mat-option *ngFor="let compound of saltCompounds"
              [value]="compound">
              {{ compound }}
            </mat-option>
          </mat-select>
        </mat-form-field>

      </div>

      <div class="col2">

        <mat-form-field class="option1-full-width_Right" appearance="fill">
          <mat-label>Total buffer conc. (M) </mat-label>
          <mat-hint *ngIf="bufferForm.get('totalConcentration').errors?.['max'] ">Conc should be less than 0.4 </mat-hint>
          <input matInput type="number" formControlName="totalConcentration" placeholder="total conc. of buffer species (M)"
            required>
        
        </mat-form-field>

        <mat-form-field class="option1-full-width_Right" appearance="fill">
          <mat-label>Salt Conc. (M) </mat-label>
          <mat-hint *ngIf="bufferForm.get('saltConcentration').errors?.['max']">Conc should be less than 1 </mat-hint>
          <input matInput type="number" formControlName="saltConcentration" placeholder="salt concentration">
        
        </mat-form-field>

        <mat-form-field class="option1-full-width_Right" appearance="fill">
          <mat-label>Target pH</mat-label>
          <mat-hint *ngIf="bufferForm.get('target_pH').errors?.['max'] || bufferForm.get('target_pH').errors?.['min'] ">Conc should be between 3 and 10 </mat-hint>
          <input matInput type="number" formControlName="target_pH" required>
       
        </mat-form-field>

      </div>
      <div *ngIf="bufferForm.hasError('invalidBufferSelection')"><p class="red_flag">Choose atleast one buffer species containing compound</p></div>
      <button class="wide-button"  mat-raised-button color="accent"
      type="submit"[disabled]="bufferForm.invalid">Get Buffer Design</button>
    </mat-card>
  </form>
  <mat-card class="summary">

    <mat-card class="solution-card" *ngIf="returnedSolution; else loadthis">
      <mat-card-header>
        <!-- <div class="avatar">{{avatarLetter}}</div> -->
        <mat-card-title>{{returnedSolution.name}}</mat-card-title>
       <mat-divider></mat-divider>
        <mat-card-subtitle>Buffer Composition Summary</mat-card-subtitle>
      </mat-card-header>
      <mat-divider></mat-divider>
      <mat-card-content
        *ngFor="let compound of returnedSolution.compound_concentrations | keyvalue">
        <p class="less-space" mat-headline-1> {{ compound.key }} : {{ compound.value | number: '1.3-3' }}M</p>
        <mat-divider></mat-divider> 
      </mat-card-content>
      <mat-divider></mat-divider>
      <!--     <mat-card-actions>
    <button mat-button>LIKE</button>
    <button mat-button>SHARE</button>
  </mat-card-actions> -->
  <h2 class="pH"> pH : {{returnedSolution.pH | number:
    '1.3-3'}}</h2>
  </mat-card>
  <mat-card class="message-card" *ngIf="returnedSolution && bufferForm.untouched==true">
   <p class="red_flag" *ngIf="returnedSolution.result_flag['flag'] !== 'green'">  <span class="material-icons">
    error
    </span>
    {{ '  '+returnedSolution.result_flag['comment'] }}
    </p>
    <p class="green_flag" *ngIf="returnedSolution.result_flag['flag'] == 'green'">  <span class="material-icons">
      check_circle
      </span>
      &nbsp; Done!
      </p>
  
  </mat-card>

    <ng-template #loadthis>
      <mat-card class="example-card-holder">
          <!--         <mat-card-header>
          <div class="avatar">{{avatarLetter}}</div>
          <mat-card-title>{{example_solution.name}}</mat-card-title>
          <mat-divider></mat-divider>
          <mat-card-subtitle>Buffer Composition Summary</mat-card-subtitle>
        </mat-card-header>
        <mat-divider></mat-divider>
        <mat-card-content
          *ngFor="let compound of example_solution.compound_concentrations | keyvalue">
          <p>{{ compound.key }} : {{ compound.value | number: '1.3-3' }}M</p>
          <mat-divider></mat-divider>
        </mat-card-content>
        <mat-divider></mat-divider>
             <mat-card-actions>
      <button mat-button>LIKE</button>
      <button mat-button>SHARE</button>
    </mat-card-actions> -->
        <!-- <h1 class="pH"> pH : {{example_solution.pH | number: '1.3-3'}}</h1> --> 
      </mat-card>
    </ng-template>

  </mat-card>

</mat-card>
